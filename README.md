# リアルタイム行動認識 PoC (概念実証)

## 1\. 概要

本プロジェクトは、Webカメラの映像から**リアルタイム**で特定の行動（例：「箒で掃く」）を認識する技術の実現可能性を検証するために実施された概念実証（PoC）です。

Googleの提供する機械学習ライブラリ`MediaPipe`を活用し、**特別な機材（GPUなど）を必要とせず、一般的なノートPCのCPUのみで高速な骨格推定と行動判定が可能であること**を実証しました。

## 2\. PoCの目的と結果

### 目的

  * ハッカソンなどの短期間開発において、\*\*「リアルタイム行動認識」\*\*をテーマとしたアプリケーションが実現可能か見極める。
  * 開発環境の構築難易度や、プロトタイプ実装に必要な工数を見積もる。
  * チームメンバーに本技術のポテンシャルとインパクトを提示し、プロジェクト採用を説得する。

-----

### 結論と成果

**目的は完全に達成されました。**

本PoCを通じて、**特別なAIの専門知識や膨大な学習データなしに、特定のポーズや単純な動作をリアルタイムで認識するプロトタイプが極めて短時間で開発可能である**ことが証明されました。

#### 成果物

  * Webカメラからの映像に対し、リアルタイムで人物の骨格を検出・描画するプログラム (`step2_pose_estimation.py`)。
  * 検出した骨格の座標データを利用し、「箒を掃く構え」を判定するロジックを実装。
  * 判定結果（例: "STATUS: Sweeping\!"）をリアルタイムで画面に表示し、技術の有効性を視覚的に実証。

#### 技術的インサイト

  * **環境構築**: 当初、WSL2環境での構築を試みましたが、カメラデバイスへのアクセスで複数の技術的課題に直面しました。最終的に**Windowsネイティブ環境**に切り替えたところ、環境構築はスムーズに完了しました。GUIやハードウェアを直接扱う開発では、ネイティブ環境を選択することが重要であるという知見を得ました。
  * **パフォーマンス**: `MediaPipe`の骨格推定モデルは非常に軽量かつ高速です。一般的なノートPCのCPUでも、リアルタイム処理（30fps前後）に全く支障がないことを確認しました。
  * **開発効率**: 骨格座標さえ取得できれば、特定の行動を判定するロジックは単純な数値計算（関節間の距離や位置関係の評価）で実装できます。これにより、**AIモデルの再学習という時間のかかるプロセスを完全に省略**でき、迅速なプロトタイピングが可能になります。

## 3\. 技術スタック

  * **Python (v3.12)**: 開発言語
  * **OpenCV (`opencv-python`)**: カメラ映像の取得と表示
  * **MediaPipe**: リアルタイム骨格推定
  * **uv**: パッケージ管理および仮想環境構築ツール

-----

## 4\. 各ファイルの説明

  * `Makefile`

      * 開発を効率化するためのコマンド（ライブラリのインストールなど）を定義したファイルです。

  * `README.md`

      * このファイルです。プロジェクトの概要、目的、成果、実行方法などを記載しています。

  * `camera_hardware_check.py`

      * PCに接続されているカメラのインデックス番号を調査するためのユーティリティスクリプトです。OpenCVがカメラを正しく認識しない場合に利用します。

  * `requirements.txt`

      * プロジェクトが依存するPythonライブラリの一覧です (`uv pip install -r` で使用)。

  * `step1_camera_test.py`

      * PoCのステップ1。OpenCVを使ってWebカメラを起動し、映像をウィンドウに表示する基本テスト用のスクリプトです。

  * `step2_pose_estimation.py`

      * PoCのステップ2であり、本プロジェクトのメインプログラムです。カメラ映像にMediaPipeで検出した骨格を重畳表示し、「箒を掃く」構えを判定するロジックを実装しています。

-----

## 5\. セットアップと実行方法

### 5.1. 前提条件

  * Windows 10 / 11
  * Python 3.12 がインストール済みであること
  * WebカメラがPCに接続されていること

### 5.2. インストール

1.  **リポジトリのクローン**

    ```bash
    git clone [リポジトリのURL]
    cd mediapipe-PoC
    ```

2.  **仮想環境の作成と有効化**
    `uv` を使用して、Python 3.12の仮想環境を構築します。

    ```powershell
    # 仮想環境の作成
    uv venv -p 3.12

    # 仮想環境の有効化
    .\.venv\Scripts\Activate.ps1
    ```

3.  **依存ライブラリのインストール**

    ```powershell
    uv pip install -r requirements.txt
    ```

### 5.3. 実行

以下のコマンドで、骨格推定と行動認識のデモを起動します。

```powershell
python step2_pose_estimation.py
```

実行後、Webカメラの映像が表示されたウィンドウが立ち上がり、検出された人物の骨格と現在のステータス（"Sweeping\!" または "Not Sweeping"）が表示されます。

ウィンドウを閉じるには、`ESC`キーを押してください。

-----

## 6\. 今後の展望

このPoCの成功を受け、以下のような応用が考えられます。

  * **インタラクティブゲーム**: 体の動きで操作するゲーム。
  * **フィットネスアプリ**: 正しいフォームをリアルタイムで評価・フィードバックする。
  * **危険行動検知**: 工場や倉庫などでの転倒やまろびを検知して通知する。

本技術は、アイデア次第で多様なアプリケーションに応用可能な、非常に強力な基盤技術であると結論付けます。